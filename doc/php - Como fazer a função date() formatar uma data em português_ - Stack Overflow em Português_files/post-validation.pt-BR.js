StackExchange.postValidation=function(){function e(e,t,n,i){var a=e.find('input[type="submit"]:visible'),o=a.length&&a.is(":enabled");o&&a.attr("disabled",!0),r(e,i),s(e,t,n,i),l(e),u(e),d(e);var p=function(){1!=t||e.find(C).length?(c(e,i),o&&a.attr("disabled",!1)):setTimeout(p,250)};p()}function t(t,i,r,s,c){e(t,i,s,r);var l,u=function(e){if(e.success)if(c)c(e);else{var n=window.location.href.split("#")[0],a=e.redirectTo.split("#")[0];0==a.indexOf("/")&&(a=window.location.protocol+"//"+window.location.hostname+a),l=!0,window.location=e.redirectTo,n.toLowerCase()==a.toLowerCase()&&window.location.reload(!0)}else e.captchaHtml?e.nocaptcha?StackExchange.nocaptcha.init(e.captchaHtml,u):StackExchange.captcha.init(e.captchaHtml,u):e.errors?(t.find("input[name=priorAttemptCount]").val(function(e,t){return(+t+1||0).toString()}),h(e.errors,t,i,r,e.warnings)):t.find('input[type="submit"]:visible').parent().showErrorMessage(e.message)};t.submit(function(){if(t.find("#answer-from-ask").is(":checked"))return!0;var e=t.find(E);if("[Edit removed during grace period]"==$.trim(e.val()))return v(e,["Comentário reservado para uso do sistema.  Use um comentário apropriado."],p()),!1;o(),StackExchange.navPrevention&&StackExchange.navPrevention.stop();var i=t.find('input[type="submit"]:visible');if(i.parent().addSpinner(),StackExchange.helpers.disableSubmitButton(t),StackExchange.options.site.enableNewTagCreationWarning){var s=t.find(C).parent().find("input#tagnames"),c=s.prop("defaultValue");if(s.val()!==c)return $.ajax({"type":"GET","url":"/posts/new-tags-warning","dataType":"json","data":{"tags":s.val()},"success":function(e){e.showWarning?i.loadPopup({"html":e.html,"dontShow":!0,"prepend":!0,"loaded":function(e){n(e,t,l,r,u)}}):a(t,r,l,u)}}),!1}return setTimeout(function(){a(t,r,l,u)},0),!1})}function n(e,t,n,o,r){e.bind("popupClose",function(){i(t,n)}),e.find(".submit-post").click(function(i){return StackExchange.helpers.closePopups(e),a(t,o,n,r),i.preventDefault(),!1}),e.show()}function i(e,t){StackExchange.helpers.removeSpinner(),t||StackExchange.helpers.enableSubmitButton(e)}function a(e,t,n,a){$.ajax({"type":"POST","dataType":"json","data":e.serialize(),"url":e.attr("action"),"success":a,"error":function(){var n;switch(t){case"question":n="Ocorreu um erro ao enviar a pergunta.";break;case"answer":n="Ocorreu um erro ao enviar a resposta.";break;case"edit":n="Ocorreu um erro ao enviar a edição.";break;case"tags":n="Ocorreu um erro ao enviar as tags.";break;case"post":default:n="Ocorreu um erro ao enviar o post."}e.find('input[type="submit"]:visible').parent().showErrorMessage(n)},"complete":function(){i(e,n)}})}function o(){for(var e=0;e<M.length;e++)clearTimeout(M[e]);M=[]}function r(e,t){var n=e.find(y);n.length&&n.blur(function(){M.push(setTimeout(function(){var i=n.val(),a=$.trim(i);if(0==a.length)return b(e,n),void 0;var o=n.data("min-length");if(o&&a.length<o)return v(n,[function(e){return 1==e.minLength?"O título deve ter pelo menos "+e.minLength+" caractere.":"O título deve ter pelo menos "+e.minLength+" caracteres."}({"minLength":o})],p()),void 0;var r=n.data("max-length");return r&&a.length>r?(v(n,[function(e){return 1==e.maxLength?"O título não pode ter mais de "+e.maxLength+" caractere.":"O título não pode ter mais de "+e.maxLength+" caracteres."}({"maxLength":r})],p()),void 0):($.ajax({"type":"POST","url":"/posts/validate-title","data":{"title":i},"success":function(i){i.success?b(e,n):v(n,i.errors.Title,p()),"edit"!=t&&g(e,n,i.warnings.Title)},"error":function(){b(e,n)}}),void 0)},_))})}function s(e,t,n,i){var a=e.find(S);a.length&&a.blur(function(){M.push(setTimeout(function(){var o=a.val(),r=$.trim(o);if(0==r.length)return b(e,a),void 0;if(5==t){var s=a.data("min-length");return s&&r.length<s?v(a,[function(e){return"O corpo de wiki deve ter pelo menos "+e.minLength+" caracteres. Você digitou "+e.actual+"."}({"minLength":s,"actual":r.length})],p()):b(e,a),void 0}(1==t||2==t)&&$.ajax({"type":"POST","url":"/posts/validate-body","data":{"body":o,"oldBody":a.prop("defaultValue"),"isQuestion":1==t,"isSuggestedEdit":n},"success":function(t){t.success?b(e,a):v(a,t.errors.Body,p()),"edit"!=i&&g(e,a,t.warnings.Body)},"error":function(){b(e,a)}})},_))})}function c(e,t){var n=e.find(C);if(n.length){var i=n.parent().find("input#tagnames");i.blur(function(){M.push(setTimeout(function(){var a=i.val(),o=$.trim(a);return 0==o.length?(b(e,n),void 0):($.ajax({"type":"POST","url":"/posts/validate-tags","data":{"tags":a,"oldTags":i.prop("defaultValue")},"success":function(i){i.success?b(e,n):v(n,i.errors.Tags,p()),"edit"!=t&&g(e,n,i.warnings.Tags)},"error":function(){b(e,n)}}),void 0)},_))})}}function l(e){var t=e.find(E);t.length&&t.blur(function(){M.push(setTimeout(function(){var n=t.val(),i=$.trim(n);if(0==i.length)return b(e,t),void 0;var a=t.data("min-length");if(a&&i.length<a)return v(t,[function(e){return 1==e.minLength?"Seu resumo de edição deve ter no mínimo "+e.minLength+" caractere.":"Seu resumo de edição deve ter no mínimo "+e.minLength+" caracteres."}({"minLength":a})],p()),void 0;var o=t.data("max-length");return o&&i.length>o?(v(t,[function(e){return 1==e.maxLength?"Seu resumo de edição não pode ter mais de "+e.maxLength+" caractere.":"Seu resumo de edição não pode ter mais de "+e.maxLength+" caracteres."}({"maxLength":o})],p()),void 0):(b(e,t),void 0)},_))})}function u(e){var t=e.find(T);t.length&&t.blur(function(){M.push(setTimeout(function(){var n=t.val(),i=$.trim(n);if(0==i.length)return b(e,t),void 0;var a=t.data("min-length");if(a&&i.length<a)return v(t,[function(e){return"O fragmento de wiki deve ter no mínimo "+e.minLength+" caracteres. Você digitou "+e.actual+"."}({"minLength":a,"actual":i.length})],p()),void 0;var o=t.data("max-length");return o&&i.length>o?(v(t,[function(e){return"O fragmento wiki não pode ter mais de "+e.maxLength+" caracteres de comprimento; você inseriu "+e.actual+"."}({"maxLength":o,"actual":i.length})],p()),void 0):(b(e,t),void 0)},_))})}function d(e){var t=e.find(I);t.length&&t.blur(function(){M.push(setTimeout(function(){var n=t.val(),i=$.trim(n);return 0==i.length?(b(e,t),void 0):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,20}$/i.test(n)?(b(e,t),void 0):(v(t,["Este e-mail não parece ser válido."],f()),void 0)},_))})}function p(){var e=$("#sidebar, .sidebar").first().width()||270;return{"position":{"my":"left top","at":"right center"},"css":{"max-width":e,"min-width":e},"closeOthers":!1}}function f(){var e=$("#sidebar, .sidebar").first().width()||270;return{"position":{"my":"left top","at":"right center"},"css":{"min-width":e},"closeOthers":!1}}function h(e,t,n,i,a){if(e){var o=function(){var n=0,o=t.find(C),r=t.find(y),s=t.find(S);v(r,e.Title,p())?n++:b(t,r),a&&g(t,r,a.Title),v(s,e.Body,p())?n++:b(t,s),a&&g(t,s,a.Body),v(o,e.Tags,p())?n++:b(t,o),a&&g(t,o,a.Tags),v(t.find(E),e.EditComment,p())?n++:b(t,t.find(E)),v(t.find(T),e.Excerpt,p())?n++:b(t,t.find(T)),v(t.find(I),e.Email,f())?n++:b(t,t.find(I));var c=t.find(".general-error"),l=e.General&&e.General.length>0;if(l||n>0){if(!c.length){var u=t.find('input[type="submit"]:visible');u.before('<div class="general-error-container"><div class="general-error"></div><br class="cbt" /></div>'),c=t.find(".general-error")}if(l)v(c,e.General,{"position":"inline","css":{"float":"left","margin-bottom":"10px"},"closeOthers":!1,"dismissable":!1});else{b(t,c);var d;switch(i){case"question":d=function(e){return 1==e.specificErrorCount?"Sua pergunta não foi enviada. Veja o erro acima.":"Sua pergunta não foi enviada. Veja os erros acima."}({"specificErrorCount":n});break;case"answer":d=function(e){return 1==e.specificErrorCount?"Sua resposta não foi enviada. Veja o erro acima.":"Sua resposta não foi enviada. Veja os erros acima."}({"specificErrorCount":n});break;case"edit":d=function(e){return 1==e.specificErrorCount?"Sua edição não foi enviada. Veja o erro acima.":"Sua edição não foi enviada. Veja os erros acima."}({"specificErrorCount":n});break;case"tags":d=function(e){return 1==e.specificErrorCount?"Suas tags não foram enviadas. Veja o erro acima.":"Suas tags não foram enviadas. Veja os erros acima."}({"specificErrorCount":n});break;case"post":default:d=function(e){return 1==e.specificErrorCount?"Seu post não foi enviado. Veja o erro acima.":"Seu post não foi enviado. Veja os erros acima."}({"specificErrorCount":n})}c.text(d)}}else t.find(".general-error-container").remove();var h;x()&&($("#sidebar").animate({"opacity":.4},500),h=setInterval(function(){x()||($("#sidebar").animate({"opacity":1},500),clearInterval(h))},500));var m;t.find(".validation-error").each(function(){var e=$(this).offset().top;(!m||m>e)&&(m=e)});var w=function(){for(var e=0;3>e;e++)t.find(".message").animate({"left":"+=5px"},100).animate({"left":"-=5px"},100)};if(m){var k=$(".review-bar").length;m=Math.max(0,m-(k?125:30)),$("html, body").animate({"scrollTop":m},w)}else w()},r=function(){1!=n||t.find(C).length?o():setTimeout(r,250)};r()}}function g(e,t,n){var i=p();if(i.type="warning",!n||0==n.length)return w(e,t),!1;var a=t.data("error-popup"),o=0;return a&&(o=a.height()+5),m(t,n,i,o)}function v(e,t,n){return n.type="error",m(e,t,n)}function m(e,t,n,i){var a,r=n.type;if(!(t&&0!=t.length&&e.length&&$("html").has(e).length))return!1;if(a=1==t.length?t[0]:"<ul><li>"+t.join("</li><li>")+"</li></ul>",a&&a.length>0){var s=e.data(r+"-popup");if(s&&s.is(":visible")){var c=e.data(r+"-message");if(c==a)return s.animateOffsetTop&&s.animateOffsetTop(i||0),!0;s.fadeOutAndRemove()}i>0&&(n.position.offsetTop=i);var l=StackExchange.helpers.showMessage(e,a,n);return l.find("a").attr("target","_blank"),l.click(o),e.addClass("validation-"+r).data(r+"-popup",l).data(r+"-message",a),!0}return!1}function w(e,t){k("warning",e,t)}function b(e,t){k("error",e,t)}function k(e,t,n){if(!n||0==n.length)return!1;var i=n.data(e+"-popup");return i&&i.is(":visible")&&i.fadeOutAndRemove(),n.removeClass("validation-"+e),n.removeData(e+"-popup"),n.removeData(e+"-message"),t.find(".validation-"+e).length||t.find(".general-"+e+"-container").remove(),!0}function x(){var e=!1,t=$("#sidebar, .sidebar").first();if(!t.length)return!1;var n=t.offset().left;return $(".message").each(function(){var t=$(this);return t.offset().left+t.outerWidth()>n?(e=!0,!1):void 0}),e}var y="input#title",S="textarea.wmd-input:first",C=".tag-editor",E="input[id^=edit-comment]",T="textarea#excerpt",I="input#m-address",M=[],_=250;return{"initOnBlur":e,"initOnBlurAndSubmit":t,"showErrorsAfterSubmission":h,"getSidebarPopupOptions":p}}();